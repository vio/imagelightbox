{"version":3,"file":"index-BbD3Pfmb.js","sources":["../../src/lib/query.ts","../../src/lib/TransitionDirection.ts","../../src/lib/history.ts","../../src/lib/container.ts","../../src/lib/activity-indicator.ts","../../src/lib/arrows.ts","../../src/lib/caption.ts","../../src/lib/close-button.ts","../../src/lib/ImageView.ts","../../src/lib/keyboard-navigation.ts","../../src/lib/navigation.ts","../../src/lib/PreloadedVideo.ts","../../src/lib/VideoCache.ts","../../src/lib/State.ts","../../src/lib/imagelightbox.ts","../../src/index.ts"],"sourcesContent":["export function addQueryField(\n  query: string,\n  key: string,\n  value: string,\n): string {\n  const newField = `${key}=${value}`;\n  let newQuery = `?${newField}`;\n\n  if (query) {\n    const keyRegex = new RegExp(`([?&])${key}=[^&]*`);\n    if (keyRegex.exec(query) !== null) {\n      newQuery = query.replace(keyRegex, `$1${newField}`);\n    } else {\n      newQuery = `${query}&${newField}`;\n    }\n  }\n  return newQuery;\n}\n\nexport function getQueryField(key: string): string | undefined {\n  const keyValuePair = new RegExp(`[?&]${key}(=([^&#]*)|&|#|$)`).exec(\n    document.location.search,\n  );\n  if (keyValuePair?.[2] === undefined) {\n    return undefined;\n  }\n  return decodeURIComponent(keyValuePair[2].replace(/\\+/g, \" \"));\n}\n\nexport function removeQueryField(query: string, key: string): string {\n  let newQuery = query;\n  if (newQuery) {\n    const keyRegex1 = new RegExp(`\\\\?${key}=[^&]*`);\n    const keyRegex2 = new RegExp(`&${key}=[^&]*`);\n    newQuery = newQuery.replace(keyRegex1, \"?\");\n    newQuery = newQuery.replace(keyRegex2, \"\");\n  }\n  return newQuery;\n}\n","export const enum TransitionDirection {\n  Left = 1,\n  None = 0,\n  Right = -1,\n}\n","import { addQueryField, getQueryField, removeQueryField } from \"./query\";\nimport { TransitionDirection } from \"./TransitionDirection\";\n\ninterface HistoryState {\n  imageLightboxIndex?: string;\n  imageLightboxSet?: string;\n}\n\nexport function pushQuitToHistory(): void {\n  let newQuery = removeQueryField(\n    document.location.search,\n    \"imageLightboxIndex\",\n  );\n  newQuery = removeQueryField(newQuery, \"imageLightboxSet\");\n  window.history.pushState({}, \"\", document.location.pathname + newQuery);\n}\n\nexport function pushToHistory(\n  index: number,\n  set: string | undefined,\n  images: Array<HTMLAnchorElement>,\n): void {\n  const newIndex = images[index].dataset[\"ilb2Id\"] ?? index.toString();\n  let newQuery = addQueryField(\n    document.location.search,\n    \"imageLightboxIndex\",\n    newIndex,\n  );\n  const newHistoryState: HistoryState = {\n    imageLightboxIndex: newIndex,\n    imageLightboxSet: \"\",\n  };\n  if (set !== undefined) {\n    newHistoryState.imageLightboxSet = set;\n    newQuery = addQueryField(newQuery, \"imageLightboxSet\", set);\n  }\n  window.history.pushState(\n    newHistoryState,\n    \"\",\n    document.location.pathname + newQuery,\n  );\n}\n\nexport function openHistory(\n  set: string | undefined,\n  images: Array<HTMLAnchorElement>,\n  open: (index: number, skipHistory?: boolean) => void,\n): void {\n  if (getQueryField(\"imageLightboxSet\") !== set) {\n    return;\n  }\n  const id = getQueryField(\"imageLightboxIndex\");\n  if (id === undefined) {\n    return;\n  }\n  let newIndex = images.findIndex((image) => image.dataset[\"ilb2Id\"] === id);\n  if (newIndex < 0) {\n    newIndex = parseInt(id, 10);\n  }\n  open(newIndex, true);\n}\n\nexport function popHistory(\n  event: PopStateEvent,\n  set: string | undefined,\n  images: Array<HTMLAnchorElement>,\n  currentIndex: number | null,\n  open: (index: number, skipHistory?: boolean) => void,\n  close: (skipHistory?: boolean) => void,\n  change: (\n    index: number,\n    transitionDirection: TransitionDirection,\n    skipHistory?: boolean,\n  ) => void,\n): void {\n  const historyState = event.state as\n    | HistoryState\n    | Record<string, never>\n    | null\n    | undefined;\n  // This needs to be before checking the set in order to close the lightbox when navigating to a non-imagelightbox state\n  if (!historyState || Object.keys(historyState).length === 0) {\n    close(true);\n    return;\n  }\n  if (historyState.imageLightboxSet !== set) {\n    return;\n  }\n  const newId = historyState.imageLightboxIndex;\n  if (newId === undefined) {\n    close(true);\n    return;\n  }\n  let newIndex = images.findIndex(\n    (e: HTMLElement) => e.dataset[\"ilb2Id\"] === newId,\n  );\n  if (newIndex < 0) {\n    newIndex = parseInt(newId, 10);\n  }\n  if (currentIndex === null) {\n    open(newIndex, true);\n    return;\n  }\n  change(\n    newIndex,\n    newIndex > currentIndex\n      ? TransitionDirection.Right\n      : TransitionDirection.Left,\n    true,\n  );\n}\n","import \"./container.css\";\n\nconst container = document.createElement(\"div\");\ncontainer.setAttribute(\"id\", \"ilb-container\");\n\nlet wrappedOnclick: ((e: Event) => void) | null = null;\n\nexport function addContainerToDOM(\n  animationSpeed: number,\n  attachOnclick: boolean,\n  onclick: () => void,\n): void {\n  container.classList.remove(\"ilb-overlay\");\n  document.body.classList.add(\"ilb-body\");\n  document.body.appendChild(container);\n  if (attachOnclick) {\n    wrappedOnclick = (e): void => {\n      e.stopPropagation();\n      onclick();\n    };\n    container.addEventListener(\"click\", wrappedOnclick);\n    container.addEventListener(\"touchend\", wrappedOnclick);\n  }\n  container.style.transition = `opacity ${animationSpeed.toString()}ms ease`;\n  setTimeout(() => {\n    container.style.opacity = \"1\";\n  }, 50);\n}\n\nexport function darkenOverlay(): void {\n  container.classList.add(\"ilb-overlay\");\n}\n\nexport function transitionOutContainer(): void {\n  container.style.opacity = \"0\";\n}\n\nexport function removeContainerFromDOM(): void {\n  if (wrappedOnclick !== null) {\n    container.removeEventListener(\"click\", wrappedOnclick);\n    container.removeEventListener(\"touchend\", wrappedOnclick);\n  }\n  container.remove();\n  container.textContent = \"\";\n  document.body.classList.remove(\"ilb-body\");\n}\n\nexport function getContainer(): HTMLDivElement {\n  return container;\n}\n","import \"./activity-indicator.css\";\nimport { getContainer } from \"./container\";\n\nconst activityIndicator = document.createElement(\"div\");\nactivityIndicator.setAttribute(\"id\", \"ilb-activity-indicator\");\nactivityIndicator.appendChild(document.createElement(\"div\"));\n\nexport function addActivityIndicatorToDOM(): void {\n  getContainer().appendChild(activityIndicator);\n}\n\nexport function removeActivityIndicatorFromDOM(): void {\n  activityIndicator.remove();\n}\n","import \"./arrows.css\";\nimport \"./button.css\";\nimport { getContainer } from \"./container\";\n\nconst leftArrow = document.createElement(\"div\");\nleftArrow.classList.add(\"ilb-button\", \"ilb-arrow\");\nleftArrow.setAttribute(\"id\", \"ilb-arrow-left\");\nconst rightArrow = document.createElement(\"div\");\nrightArrow.classList.add(\"ilb-button\", \"ilb-arrow\");\nrightArrow.setAttribute(\"id\", \"ilb-arrow-right\");\n\nlet wrappedLeft: ((e: Event) => void) | null = null;\nlet wrappedRight: ((e: Event) => void) | null = null;\n\nexport function addArrowsToDOM(onleft: () => void, onright: () => void): void {\n  wrappedLeft = (e): void => {\n    e.stopPropagation();\n    onleft();\n  };\n  wrappedRight = (e): void => {\n    e.stopPropagation();\n    onright();\n  };\n  leftArrow.addEventListener(\"click\", wrappedLeft);\n  leftArrow.addEventListener(\"touchend\", wrappedLeft);\n  rightArrow.addEventListener(\"click\", wrappedRight);\n  rightArrow.addEventListener(\"touchend\", wrappedRight);\n  getContainer().append(leftArrow, rightArrow);\n}\n\nexport function removeArrowsFromDOM(): void {\n  leftArrow.remove();\n  if (wrappedLeft !== null) {\n    leftArrow.removeEventListener(\"click\", wrappedLeft);\n    leftArrow.removeEventListener(\"touchend\", wrappedLeft);\n  }\n  if (wrappedRight !== null) {\n    rightArrow.removeEventListener(\"click\", wrappedRight);\n    rightArrow.removeEventListener(\"touchend\", wrappedRight);\n  }\n  wrappedLeft = null;\n  wrappedRight = null;\n}\n","import \"./caption.css\";\nimport { getContainer } from \"./container\";\n\nconst caption = document.createElement(\"caption\");\ncaption.setAttribute(\"id\", \"ilb-caption\");\ncaption.textContent = \"&nbsp;\";\ncaption.addEventListener(\"click\", (e) => {\n  e.stopPropagation();\n});\n\nexport function setCaption(captionText: string, animationSpeed: number): void {\n  if (captionText !== \"\") {\n    getContainer().appendChild(caption);\n    caption.style.transition = `opacity ${animationSpeed.toString()}ms ease`;\n    setTimeout(() => {\n      caption.style.opacity = \"1\";\n    }, 1);\n    caption.textContent = captionText;\n  } else {\n    caption.style.opacity = \"0\";\n    setTimeout(() => {\n      caption.remove();\n    }, animationSpeed);\n  }\n}\n","import \"./button.css\";\nimport \"./close-button.css\";\nimport { getContainer } from \"./container\";\n\nconst closeButton = document.createElement(\"button\");\ncloseButton.classList.add(\"ilb-button\");\ncloseButton.setAttribute(\"id\", \"ilb-close-button\");\n\nlet wrappedClose: ((e: Event) => void) | null = null;\n\nexport function addCloseButtonToDOM(onclick: () => void): void {\n  wrappedClose = (e): void => {\n    e.stopPropagation();\n    onclick();\n  };\n  closeButton.addEventListener(\"click\", wrappedClose);\n  getContainer().appendChild(closeButton);\n}\n\nexport function removeCloseButtonFromDOM(): void {\n  if (wrappedClose !== null) {\n    closeButton.removeEventListener(\"click\", wrappedClose);\n  }\n  closeButton.remove();\n}\n","import type { VideoCache } from \"./VideoCache\";\n\nimport { getContainer } from \"./container\";\nimport \"./ImageView.css\";\nimport { TransitionDirection } from \"./TransitionDirection\";\n\nexport interface ImageView {\n  addToDOM(\n    transitionDirection: TransitionDirection,\n    callback: () => void,\n  ): void;\n  removeFromDOM(): void;\n  startLoading(onload: () => void, onerror: () => void): void;\n  transitionIn(\n    callback: () => void,\n    previousImage: () => void,\n    nextImage: () => void,\n    closeLightbox: () => void,\n  ): void;\n  transitionOut(\n    transitionDirection: TransitionDirection,\n    callback: () => void,\n  ): void;\n}\n\nexport function ImageView(\n  image: HTMLAnchorElement,\n  options: ILBOptions,\n  videoCache: VideoCache,\n): ImageView {\n  let swipeStart = 0;\n  let swipeDiff = 0;\n  let imageElement: HTMLImageElement | HTMLVideoElement =\n    document.createElement(\"img\");\n  imageElement.setAttribute(\"id\", \"ilb-image\");\n  imageElement.setAttribute(\"src\", image.getAttribute(\"href\") ?? \"\");\n  const containerElement = document.createElement(\"div\");\n  containerElement.classList.add(\"ilb-image-container\");\n  let isVideoPreloaded: boolean | undefined = undefined;\n\n  const videoId = image.dataset[\"ilb2VideoId\"];\n  let isVideo =\n    image.dataset[\"ilb2Video\"] !== undefined && videoId !== undefined;\n  if (isVideo) {\n    // eslint-disable-next-line @typescript-eslint/no-non-null-assertion -- Checked by the if above\n    const videoElement = videoCache.element(videoId!);\n    if (videoElement !== undefined) {\n      [imageElement, isVideoPreloaded] = videoElement;\n    } else {\n      isVideo = false;\n    }\n  }\n  containerElement.appendChild(imageElement);\n\n  function onready(\n    callback: () => void,\n    previousImage: () => void,\n    nextImage: () => void,\n    closeLightbox: () => void,\n  ): void {\n    if (!isVideo) {\n      (imageElement as HTMLImageElement).addEventListener(\"click\", (e) => {\n        e.stopPropagation();\n        if (options.quitOnImgClick) {\n          closeLightbox();\n          return;\n        }\n        const xPosRelativeToImage =\n          (e.pageX - imageElement.offsetLeft) / imageElement.width;\n        if (xPosRelativeToImage <= 1 / 3) {\n          previousImage();\n        } else {\n          nextImage();\n        }\n      });\n    }\n    imageElement.addEventListener(\"touchstart\", (e) => {\n      swipeStart = (e as TouchEvent).touches[0].pageX;\n      imageElement.style.transitionProperty = \"opacity\";\n    });\n    imageElement.addEventListener(\"touchmove\", (e) => {\n      swipeDiff = (e as TouchEvent).touches[0].pageX - swipeStart;\n      imageElement.style.left = `${swipeDiff.toString()}px`;\n    });\n    imageElement.addEventListener(\"touchend\", (e) => {\n      e.stopPropagation();\n      imageElement.style.transitionProperty = \"left, opacity\";\n      if (swipeDiff > 50) {\n        previousImage();\n      }\n      if (swipeDiff < -50) {\n        nextImage();\n      }\n      imageElement.style.left = \"0\";\n    });\n    imageElement.addEventListener(\"touchcancel\", (e) => {\n      e.stopPropagation();\n      imageElement.style.transitionProperty = \"left, opacity\";\n      imageElement.style.left = \"0\";\n    });\n    callback();\n  }\n\n  function addToDOM(\n    transitionDirection: TransitionDirection,\n    callback: () => void,\n  ): void {\n    getContainer().appendChild(containerElement);\n    const maxSize = Math.abs(100 - options.gutter);\n    imageElement.style.maxHeight = `${maxSize.toString()}%`;\n    imageElement.style.maxWidth = `${maxSize.toString()}%`;\n    imageElement.style.left = `${(-100 * transitionDirection).toString()}px`;\n    imageElement.style.transition = `all ease ${options.animationSpeed.toString()}ms`;\n    setTimeout(callback, 50);\n  }\n\n  function startLoading(onload: () => void, onerror: () => void): void {\n    imageElement.addEventListener(\"error\", onerror);\n    if (isVideoPreloaded === true) {\n      onload();\n    } else {\n      imageElement.addEventListener(\"load\", onload);\n      imageElement.addEventListener(\"loadedmetadata\", onload);\n    }\n  }\n\n  function transitionIn(\n    callback: () => void,\n    previousImage: () => void,\n    nextImage: () => void,\n    closeLightbox: () => void,\n  ): void {\n    imageElement.style.left = \"0\";\n    imageElement.style.opacity = \"1\";\n    setTimeout(() => {\n      onready(callback, previousImage, nextImage, closeLightbox);\n    }, options.animationSpeed);\n  }\n\n  function transitionOut(\n    transitionDirection: TransitionDirection,\n    callback: () => void,\n  ): void {\n    if (transitionDirection !== TransitionDirection.None) {\n      const currentLeft = parseInt(imageElement.style.left, 10) || 0;\n      imageElement.style.left = `${(currentLeft + 100 * transitionDirection).toString()}px`;\n    }\n    imageElement.style.opacity = \"0\";\n    setTimeout(() => {\n      callback();\n    }, options.animationSpeed);\n  }\n\n  function removeFromDOM(): void {\n    containerElement.remove();\n  }\n\n  return {\n    addToDOM,\n    removeFromDOM,\n    startLoading,\n    transitionIn,\n    transitionOut,\n  };\n}\n","import { getContainer } from \"./container\";\n\nconst fullscreenEnabled: boolean =\n  // eslint-disable-next-line compat/compat -- The prefixed version fixes the incompatibility\n  document.fullscreenEnabled ||\n  ((document as LegacyDocument).webkitFullscreenEnabled ?? false);\n\nlet keyHandler: ((e: KeyboardEvent) => void) | null = null;\n\nfunction toggleFullScreen(): void {\n  const container = getContainer();\n\n  /* eslint-disable compat/compat, @typescript-eslint/no-unnecessary-condition, @typescript-eslint/strict-boolean-expressions -- Polyfills for very old browsers */\n  const requestFullscreen = (): void => {\n    void (\n      container.requestFullscreen ||\n      (container as LegacyHTMLElement).webkitRequestFullScreen\n    ).call(container);\n  };\n  const exitFullScreen = (): void => {\n    void (\n      document.exitFullscreen ||\n      (document as LegacyDocument).webkitExitFullscreen\n    ).call(document);\n  };\n  /* eslint-enable */\n\n  if (\n    !document.fullscreenElement &&\n    !(document as LegacyDocument).webkitFullscreenElement\n  ) {\n    requestFullscreen();\n  } else {\n    exitFullScreen();\n  }\n}\n\nfunction fullscreenKeyHandler(e: KeyboardEvent): void {\n  if (e.key === \"Enter\") {\n    e.preventDefault();\n    toggleFullScreen();\n  }\n}\n\nexport function addKeyboardNavigation(\n  options: ILBOptions,\n  closeLightbox: () => void,\n  previousImage: () => void,\n  nextImage: () => void,\n): void {\n  if (options.fullscreen && fullscreenEnabled) {\n    document.addEventListener(\"keypress\", fullscreenKeyHandler);\n  }\n\n  if (options.enableKeyboard) {\n    keyHandler = (e): void => {\n      if (options.quitOnEscKey && e.key === \"Escape\") {\n        e.preventDefault();\n        closeLightbox();\n      }\n      if (e.key === \"ArrowLeft\") {\n        e.preventDefault();\n        previousImage();\n      }\n      if (e.key === \"ArrowRight\") {\n        e.preventDefault();\n        nextImage();\n      }\n    };\n    document.addEventListener(\"keyup\", keyHandler);\n  }\n}\n\nexport function removeKeyboardNavigation(): void {\n  document.removeEventListener(\"keypress\", fullscreenKeyHandler);\n  if (keyHandler !== null) {\n    document.removeEventListener(\"keyup\", keyHandler);\n  }\n}\n","import { getContainer } from \"./container\";\nimport \"./navigation.css\";\nimport { TransitionDirection } from \"./TransitionDirection\";\n\nconst navigation = document.createElement(\"div\");\nnavigation.classList.add(\"ilb-navigation\");\n\nexport function addNavigationItems(\n  images: Array<HTMLAnchorElement>,\n  currentIndexFn: () => number | null,\n  change: (index: number, transitionDirection: TransitionDirection) => void,\n  animationSpeed: number,\n): void {\n  // eslint-disable-next-line @typescript-eslint/prefer-for-of -- The result won't be used anyway\n  for (let i = 0; i < images.length; i++) {\n    const button = document.createElement(\"button\");\n    button.style.transition = `background-color ${animationSpeed.toString()}ms ease`;\n    const buttonClick = (): void => {\n      const currentIndex = currentIndexFn();\n      if (\n        button.classList.contains(\"ilb-navigation-active\") ||\n        currentIndex === null ||\n        button.parentNode === null\n      ) {\n        return;\n      }\n      const buttonIndex = Array.prototype.indexOf.call(\n        button.parentNode.childNodes,\n        button,\n      );\n      const loadDirection =\n        buttonIndex < currentIndex\n          ? TransitionDirection.Left\n          : TransitionDirection.Right;\n      change(buttonIndex, loadDirection);\n    };\n    button.addEventListener(\"click\", buttonClick);\n    button.addEventListener(\"touchend\", buttonClick);\n    navigation.appendChild(button);\n  }\n}\n\nexport function changeNavigationCurrent(currentIndex: number): void {\n  for (let i = 0; i < navigation.children.length; i++) {\n    navigation.children.item(i)?.classList.remove(\"ilb-navigation-active\");\n  }\n  navigation.children\n    .item(currentIndex)\n    ?.classList.add(\"ilb-navigation-active\");\n}\n\nexport function addNavigationToDOM(\n  images: Array<HTMLAnchorElement>,\n  currentIndexFn: () => number | null,\n  change: (index: number, transitionDirection: TransitionDirection) => void,\n  animationSpeed: number,\n): void {\n  navigation.textContent = \"\";\n  addNavigationItems(images, currentIndexFn, change, animationSpeed);\n  const currentIndex = currentIndexFn();\n  if (currentIndex !== null) {\n    changeNavigationCurrent(currentIndex);\n  }\n  getContainer().appendChild(navigation);\n\n  navigation.addEventListener(\"click\", (e) => {\n    e.stopPropagation();\n  });\n  navigation.addEventListener(\"touchend\", (e) => {\n    e.stopPropagation();\n  });\n}\n","import type { VideoOptions } from \"./interfaces/VideoOptions\";\n\nexport interface PreloadedVideo {\n  element(): [HTMLVideoElement, boolean];\n  id(): string;\n}\n\nexport function PreloadedVideo(\n  image: HTMLAnchorElement,\n  videoOptions: VideoOptions,\n): PreloadedVideo {\n  let tempId = image.dataset[\"ilb2Id\"];\n  if (tempId === undefined) {\n    // Random id\n    tempId = `a${(((1 + Math.random()) * 0x10000) | 0).toString(16)}`;\n  }\n  image.dataset[\"ilb2VideoId\"] = tempId;\n  const videoId = tempId;\n\n  const videoElement = document.createElement(\"video\");\n  videoElement.setAttribute(\"id\", \"ilb-image\");\n  videoElement.preload = \"metadata\";\n  videoElement.dataset[\"ilb2VideoId\"] = videoId;\n  let isLoaded = false;\n  let autoplay = false;\n\n  for (const [key, value] of Object.entries(videoOptions)) {\n    switch (key) {\n      case \"autoplay\":\n        autoplay = true;\n        break;\n      case \"controls\":\n      case \"loop\":\n      case \"muted\":\n      case \"poster\":\n      case \"preload\":\n      case \"src\":\n        videoElement.setAttribute(key, (value as number | string).toString());\n        break;\n      default:\n    }\n  }\n  if (videoOptions.sources) {\n    for (const source of videoOptions.sources) {\n      const sourceElement = document.createElement(\"source\");\n      for (const [key, value] of Object.entries(source)) {\n        sourceElement.setAttribute(key, value as string);\n      }\n      videoElement.appendChild(sourceElement);\n    }\n  }\n  videoElement.addEventListener(\"loadedmetadata\", () => {\n    isLoaded = true;\n  });\n\n  function id(): string {\n    return videoId;\n  }\n\n  function element(): [HTMLVideoElement, boolean] {\n    if (autoplay) {\n      if (isLoaded) {\n        void videoElement.play();\n      } else {\n        videoElement.autoplay = true;\n      }\n    }\n    return [videoElement, isLoaded];\n  }\n\n  return {\n    element,\n    id,\n  };\n}\n","import type { VideoOptions } from \"./interfaces/VideoOptions\";\n\nimport { PreloadedVideo } from \"./PreloadedVideo\";\n\nexport interface VideoCache {\n  add(elements: Array<HTMLAnchorElement>): void;\n  element(videoId: string): [HTMLVideoElement, boolean] | undefined;\n}\n\nexport function VideoCache(): VideoCache {\n  const videos: Array<PreloadedVideo> = [];\n\n  function add(elements: Array<HTMLAnchorElement>): void {\n    for (const image of elements) {\n      const videoOptions = image.dataset[\"ilb2Video\"];\n      if (videoOptions === undefined) {\n        continue;\n      }\n      videos.push(\n        PreloadedVideo(image, JSON.parse(videoOptions) as VideoOptions),\n      );\n    }\n  }\n\n  function element(videoId: string): [HTMLVideoElement, boolean] | undefined {\n    const video = videos.find((x) => x.id() === videoId);\n    return video?.element();\n  }\n\n  return {\n    add,\n    element,\n  };\n}\n","import {\n  addActivityIndicatorToDOM,\n  removeActivityIndicatorFromDOM,\n} from \"./activity-indicator\";\nimport { addArrowsToDOM, removeArrowsFromDOM } from \"./arrows\";\nimport { setCaption } from \"./caption\";\nimport { addCloseButtonToDOM, removeCloseButtonFromDOM } from \"./close-button\";\nimport {\n  addContainerToDOM,\n  darkenOverlay,\n  getContainer,\n  removeContainerFromDOM,\n  transitionOutContainer,\n} from \"./container\";\nimport { popHistory, pushQuitToHistory, pushToHistory } from \"./history\";\nimport { ImageView } from \"./ImageView\";\nimport {\n  addKeyboardNavigation,\n  removeKeyboardNavigation,\n} from \"./keyboard-navigation\";\nimport {\n  addNavigationItems,\n  addNavigationToDOM,\n  changeNavigationCurrent,\n} from \"./navigation\";\nimport { TransitionDirection } from \"./TransitionDirection\";\nimport { VideoCache } from \"./VideoCache\";\n\nexport interface State {\n  addImages(images: Array<HTMLAnchorElement>): void;\n  close(skipHistory?: boolean): void;\n  images(): Array<HTMLAnchorElement>;\n  next(): void;\n  open(index: number, skipHistory?: boolean): void;\n  openWithImage(image: HTMLAnchorElement): void;\n  previous(): void;\n  set(): string | undefined;\n}\n\nexport function State(\n  // The lightbox options\n  options: ILBOptions,\n  // The value of data-imagelightbox on the images\n  lightboxSet: string | undefined,\n  initialImages: Array<HTMLAnchorElement>,\n): State {\n  // The clickable images in the lightbox\n  const targetImages: Array<HTMLAnchorElement> = [];\n\n  // Cached preloaded videos\n  const videoCache: VideoCache = VideoCache();\n\n  // The index of the currently open image, or null if the lightbox is closed\n  let currentImage: number | null = null;\n\n  // The currently displayed image view\n  let currentImageView: ImageView | null = null;\n\n  // !!! State initialization is at the bottom!\n\n  function set(): string | undefined {\n    return lightboxSet;\n  }\n\n  function images(): Array<HTMLAnchorElement> {\n    return targetImages;\n  }\n\n  /**\n   * The lightbox transition functions.\n   *\n   * The most important part of the State is managing the transition lifecycle. When transitioning between images, the lifecycle takes the following steps:\n   *\n   * For transitioning out an old image:\n   *\n   * 1. Start visually transitioning the old image out (slide + fade out)\n   * 2. When the image is visually gone, actually remove it from the DOM\n   *\n   * For transitioning in a new image:\n   *\n   * 1. Start loading the new image in the background (startLoadingNewImage)\n   * 2. When the new image is loaded, add it to the DOM, but keep it invisible (addNewImage)\n   * 3. After adding the image to the DOM, transition it into place - slide + fade in (transitionInNewImage)\n   */\n\n  function removeOldImage(\n    transitionDirection: TransitionDirection,\n    callback?: () => void,\n  ): void {\n    if (currentImageView === null) {\n      return;\n    }\n    const oldImageView = currentImageView;\n    oldImageView.transitionOut(transitionDirection, () => {\n      oldImageView.removeFromDOM();\n      callback?.();\n    });\n  }\n\n  function transitionInNewImage(): void {\n    currentImageView?.transitionIn(\n      removeActivityIndicatorFromDOM,\n      /* eslint-disable @typescript-eslint/no-use-before-define -- Cyclical dependencies */\n      previous,\n      next,\n      close,\n      /* eslint-enable */\n    );\n  }\n\n  function addNewImage(transitionDirection: TransitionDirection): void {\n    currentImageView?.addToDOM(transitionDirection, () => {\n      if (currentImage === null) {\n        return;\n      }\n      const image = targetImages[currentImage];\n      if (options.caption) {\n        setCaption(\n          image.dataset[\"ilb2Caption\"] ??\n            image.getElementsByTagName(\"img\").item(0)?.alt ??\n            \"\",\n          options.animationSpeed,\n        );\n      }\n      transitionInNewImage();\n      if (options.preloadNext && currentImage + 1 < targetImages.length) {\n        const nextImage = targetImages[currentImage + 1];\n        const nextImageElement = document.createElement(\"img\");\n        nextImageElement.setAttribute(\n          \"src\",\n          nextImage.getAttribute(\"href\") ?? \"\",\n        );\n      }\n      getContainer().dispatchEvent(new Event(\"ilb:loaded\", { bubbles: true }));\n    });\n  }\n\n  function startLoadingNewImage(\n    newIndex: number,\n    transitionDirection: TransitionDirection,\n  ): void {\n    const newImageView = ImageView(targetImages[newIndex], options, videoCache);\n    currentImage = newIndex;\n    currentImageView = newImageView;\n    newImageView.startLoading(\n      () => {\n        addNewImage(transitionDirection);\n      },\n      () => {\n        removeActivityIndicatorFromDOM();\n      },\n    );\n  }\n\n  // Public functions wrapping the state transition functions\n\n  function close(skipHistory = false): void {\n    if (currentImage === null) {\n      return;\n    }\n    if (options.activity) {\n      addActivityIndicatorToDOM();\n    }\n\n    removeKeyboardNavigation();\n\n    if (options.history && !skipHistory) {\n      pushQuitToHistory();\n    }\n\n    getContainer().dispatchEvent(new Event(\"ilb:quit\", { bubbles: true }));\n\n    transitionOutContainer();\n    removeOldImage(TransitionDirection.None, () => {\n      currentImage = null;\n      currentImageView = null;\n      removeArrowsFromDOM();\n      removeCloseButtonFromDOM();\n      removeContainerFromDOM();\n    });\n  }\n\n  function change(\n    index: number,\n    transitionDirection: TransitionDirection,\n    skipHistory = false,\n  ): void {\n    if (currentImage === null) {\n      return;\n    }\n\n    if (options.history && !skipHistory) {\n      pushToHistory(index, set(), images());\n    }\n\n    if (options.activity) {\n      addActivityIndicatorToDOM();\n    }\n    changeNavigationCurrent(index);\n\n    removeOldImage(transitionDirection);\n    startLoadingNewImage(index, transitionDirection);\n  }\n\n  function previous(): void {\n    if (currentImage === null) {\n      return;\n    }\n\n    let newIndex = currentImage - 1;\n    if (currentImage === 0) {\n      if (options.quitOnEnd) {\n        close();\n        return;\n      }\n      newIndex = targetImages.length - 1;\n    }\n    targetImages[newIndex].dispatchEvent(\n      new Event(\"ilb:previous\", { bubbles: true }),\n    );\n    change(newIndex, TransitionDirection.Left);\n  }\n\n  function next(): void {\n    if (currentImage === null) {\n      return;\n    }\n\n    let newIndex = currentImage + 1;\n    if (currentImage === targetImages.length - 1) {\n      if (options.quitOnEnd) {\n        close();\n        return;\n      }\n      newIndex = 0;\n    }\n    targetImages[newIndex].dispatchEvent(\n      new Event(\"ilb:next\", { bubbles: true }),\n    );\n    change(newIndex, TransitionDirection.Right);\n  }\n\n  function open(index: number, skipHistory = false): void {\n    if (currentImage !== null) {\n      return;\n    }\n    addContainerToDOM(options.animationSpeed, options.quitOnDocClick, close);\n    if (options.activity) {\n      addActivityIndicatorToDOM();\n    }\n    addKeyboardNavigation(options, close, previous, next);\n    if (options.arrows) {\n      addArrowsToDOM(previous, next);\n    }\n    if (options.button) {\n      addCloseButtonToDOM(close);\n    }\n    if (options.navigation) {\n      addNavigationToDOM(\n        images(),\n        () => currentImage,\n        change,\n        options.animationSpeed,\n      );\n    }\n    if (options.overlay) {\n      darkenOverlay();\n    }\n\n    if (options.history && !skipHistory) {\n      pushToHistory(index, set(), images());\n    }\n\n    targetImages[index].dispatchEvent(\n      new Event(\"ilb:start\", { bubbles: true }),\n    );\n    startLoadingNewImage(index, TransitionDirection.None);\n  }\n\n  function openWithImage(image: HTMLAnchorElement): void {\n    const index = targetImages.indexOf(image);\n    if (index < 0) {\n      return;\n    }\n    open(index);\n  }\n\n  function addImages(newImages: Array<HTMLAnchorElement>): void {\n    const validImages = newImages\n      .filter((x) => !targetImages.includes(x))\n      .filter(\n        (element): boolean =>\n          element.tagName.toLowerCase() === \"a\" &&\n          (new RegExp(`.(${options.allowedTypes})$`, \"i\").test(element.href) ||\n            element.dataset[\"ilb2Video\"] !== undefined),\n      );\n    videoCache.add(validImages);\n    targetImages.push(...validImages);\n    for (const image of validImages) {\n      image.addEventListener(\"click\", (e) => {\n        e.preventDefault();\n        e.stopPropagation();\n        openWithImage(image);\n      });\n    }\n    addNavigationItems(\n      validImages,\n      () => currentImage,\n      change,\n      options.animationSpeed,\n    );\n  }\n\n  // State initialization\n\n  addImages(initialImages);\n\n  if (options.history) {\n    window.addEventListener(\"popstate\", (e) => {\n      popHistory(e, set(), images(), currentImage, open, close, change);\n    });\n  }\n\n  return {\n    addImages,\n    close,\n    images,\n    next,\n    open,\n    openWithImage,\n    previous,\n    set,\n  };\n}\n","import { openHistory } from \"./history\";\nimport { State } from \"./State\";\n\nexport class ImageLightbox {\n  private readonly s: State;\n\n  public constructor(\n    images:\n      | Array<HTMLAnchorElement>\n      | HTMLCollectionOf<HTMLAnchorElement>\n      | NodeListOf<HTMLAnchorElement>,\n    options?: Partial<ILBOptions>,\n  ) {\n    const opts: ILBOptions = {\n      activity: false,\n      allowedTypes: \"png|jpg|jpeg|gif\",\n      animationSpeed: 250,\n      arrows: false,\n      button: false,\n      caption: false,\n      enableKeyboard: true,\n      fullscreen: false,\n      gutter: 10,\n      history: false,\n      navigation: false,\n      overlay: false,\n      preloadNext: true,\n      quitOnDocClick: true,\n      quitOnEnd: false,\n      quitOnEscKey: true,\n      quitOnImgClick: false,\n      ...options,\n    };\n    this.s = State(\n      opts,\n      images.length > 0 ? (images[0].dataset[\"imagelightbox\"] ?? \"\") : \"\",\n      Array.from(images),\n    );\n\n    if (opts.history) {\n      this.openHistory();\n    }\n  }\n\n  public addImages(\n    images:\n      | Array<HTMLAnchorElement>\n      | HTMLCollectionOf<HTMLAnchorElement>\n      | NodeListOf<HTMLAnchorElement>,\n  ): void {\n    this.s.addImages(Array.from(images));\n  }\n\n  public close(): void {\n    this.s.close();\n  }\n\n  public next(): void {\n    this.s.next();\n  }\n\n  public open(image?: HTMLAnchorElement): void {\n    if (image !== undefined) {\n      this.s.openWithImage(image);\n    } else {\n      this.s.open(0);\n    }\n  }\n\n  public openHistory(): void {\n    openHistory(\n      this.s.set(),\n      this.s.images(),\n      (index: number, skipHistory?: boolean) => {\n        this.s.open(index, skipHistory);\n      },\n    );\n  }\n\n  public previous(): void {\n    this.s.previous();\n  }\n}\n","import { ImageLightbox } from \"./lib/imagelightbox\";\n\ndeclare const TEST: boolean | undefined;\nconst isTest: boolean = typeof TEST !== \"undefined\" ? TEST : false;\n\nnew ImageLightbox(document.querySelectorAll('a[data-imagelightbox=\"a\"]'), {\n  activity: true,\n});\n\nnew ImageLightbox(\n  document.querySelectorAll('a[data-imagelightbox=\"allowedtypes\"]'),\n  {\n    allowedTypes: \"gif\",\n    ...(isTest && { animationSpeed: 0 }),\n  },\n);\n\nnew ImageLightbox(document.querySelectorAll('a[data-imagelightbox=\"b\"]'), {\n  overlay: true,\n  ...(isTest && { animationSpeed: 0 }),\n});\n\nnew ImageLightbox(document.querySelectorAll('a[data-imagelightbox=\"c\"]'), {\n  button: true,\n  quitOnDocClick: false,\n  ...(isTest && { animationSpeed: 0 }),\n});\n\nnew ImageLightbox(document.querySelectorAll('a[data-imagelightbox=\"d\"]'), {\n  caption: true,\n  ...(isTest && { animationSpeed: 0 }),\n});\n\nnew ImageLightbox(document.querySelectorAll('a[data-imagelightbox=\"e\"]'), {\n  navigation: true,\n  ...(isTest && { animationSpeed: 0 }),\n});\n\nnew ImageLightbox(document.querySelectorAll('a[data-imagelightbox=\"f\"]'), {\n  arrows: true,\n  ...(isTest && { animationSpeed: 0 }),\n});\n\nnew ImageLightbox(document.querySelectorAll('a[data-imagelightbox=\"quit\"]'), {\n  quitOnEnd: true,\n  quitOnImgClick: true,\n  ...(isTest && { animationSpeed: 0 }),\n});\n\nnew ImageLightbox(\n  document.querySelectorAll('a[data-imagelightbox=\"fullscreen\"]'),\n  {\n    fullscreen: true,\n    ...(isTest && { animationSpeed: 0 }),\n  },\n);\n\nnew ImageLightbox(document.querySelectorAll('a[data-imagelightbox=\"g\"]'), {\n  activity: true,\n  arrows: true,\n  button: true,\n  caption: true,\n  navigation: true,\n  overlay: true,\n  quitOnDocClick: false,\n  ...(isTest && { animationSpeed: 0 }),\n});\n\nconst manualOpenGallery = new ImageLightbox(\n  document.querySelectorAll('a[data-imagelightbox=\"h\"]'),\n  {\n    arrows: true,\n    ...(isTest && { animationSpeed: 0 }),\n  },\n);\ndocument\n  .getElementsByClassName(\"trigger_lightbox\")\n  .item(0)\n  ?.addEventListener(\"click\", () => {\n    manualOpenGallery.open();\n  });\n\nconst dynamicAddingGallery = new ImageLightbox(\n  document.querySelectorAll('a[data-imagelightbox=\"i\"]'),\n  {\n    arrows: true,\n    ...(isTest && { animationSpeed: 0 }),\n  },\n);\ndocument\n  .getElementsByClassName(\"add_image\")\n  .item(0)\n  ?.addEventListener(\"click\", () => {\n    const linkContainer = document\n      .getElementsByClassName(\"demo_dynamic\")\n      .item(0);\n    const newLi = document.createElement(\"li\");\n    linkContainer?.appendChild(newLi);\n\n    const newAnchor = document.createElement(\"a\");\n    newAnchor.dataset[\"imagelightbox\"] = \"i\";\n    newAnchor.href = \"images/demo4.jpg\";\n    newLi.appendChild(newAnchor);\n\n    const newImg = document.createElement(\"img\");\n    newImg.src = \"images/thumb4.jpg\";\n    newAnchor.appendChild(newImg);\n\n    dynamicAddingGallery.addImages(\n      document.querySelectorAll('a[data-imagelightbox=\"i\"]'),\n    );\n  });\n\nnew ImageLightbox(document.querySelectorAll('a[data-imagelightbox=\"j\"]'), {\n  arrows: true,\n  history: true,\n  ...(isTest && { animationSpeed: 0 }),\n});\n\nnew ImageLightbox(document.querySelectorAll('a[data-imagelightbox=\"k\"]'), {\n  arrows: true,\n  history: true,\n  ...(isTest && { animationSpeed: 0 }),\n});\n\nnew ImageLightbox(document.querySelectorAll('a[data-imagelightbox=\"video\"]'), {\n  activity: true,\n  arrows: true,\n  overlay: true,\n  ...(isTest && { animationSpeed: 0 }),\n});\n\nnew ImageLightbox(document.querySelectorAll('a[data-imagelightbox=\"events\"]'), {\n  ...(isTest && { animationSpeed: 0 }),\n});\n\n/* eslint-disable no-console -- This is the docs */\ndocument.addEventListener(\"ilb:start\", (e) => {\n  console.log(\"ilb:start\");\n  console.log(e.target);\n});\ndocument.addEventListener(\"ilb:quit\", () => {\n  console.log(\"ilb:quit\");\n});\ndocument.addEventListener(\"ilb:loaded\", () => {\n  console.log(\"ilb:loaded\");\n});\ndocument.addEventListener(\"ilb:previous\", (e) => {\n  console.log(\"ilb:previous\");\n  console.log(e.target);\n});\ndocument.addEventListener(\"ilb:next\", (e) => {\n  console.log(\"ilb:next\");\n  console.log(e.target);\n});\n/* eslint-enable no-console */\n"],"names":["addQueryField","query","key","value","newField","newQuery","keyRegex","getQueryField","keyValuePair","removeQueryField","keyRegex1","keyRegex2","TransitionDirection","pushQuitToHistory","pushToHistory","index","set","images","newIndex","newHistoryState","openHistory","open","id","image","popHistory","event","currentIndex","close","change","historyState","newId","e","container","wrappedOnclick","addContainerToDOM","animationSpeed","attachOnclick","onclick","darkenOverlay","transitionOutContainer","removeContainerFromDOM","getContainer","activityIndicator","addActivityIndicatorToDOM","removeActivityIndicatorFromDOM","leftArrow","rightArrow","wrappedLeft","wrappedRight","addArrowsToDOM","onleft","onright","removeArrowsFromDOM","caption","setCaption","captionText","closeButton","wrappedClose","addCloseButtonToDOM","removeCloseButtonFromDOM","ImageView","options","videoCache","swipeStart","swipeDiff","imageElement","containerElement","isVideoPreloaded","videoId","isVideo","videoElement","onready","callback","previousImage","nextImage","closeLightbox","addToDOM","transitionDirection","maxSize","startLoading","onload","onerror","transitionIn","transitionOut","currentLeft","removeFromDOM","fullscreenEnabled","keyHandler","toggleFullScreen","requestFullscreen","exitFullScreen","fullscreenKeyHandler","addKeyboardNavigation","removeKeyboardNavigation","navigation","addNavigationItems","currentIndexFn","button","buttonClick","buttonIndex","loadDirection","changeNavigationCurrent","i","_a","_b","addNavigationToDOM","PreloadedVideo","videoOptions","tempId","isLoaded","autoplay","source","sourceElement","element","VideoCache","videos","add","elements","video","x","State","lightboxSet","initialImages","targetImages","currentImage","currentImageView","removeOldImage","oldImageView","transitionInNewImage","previous","next","addNewImage","startLoadingNewImage","newImageView","skipHistory","openWithImage","addImages","newImages","validImages","ImageLightbox","opts","isTest","manualOpenGallery","dynamicAddingGallery","linkContainer","newLi","newAnchor","newImg"],"mappings":"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"}